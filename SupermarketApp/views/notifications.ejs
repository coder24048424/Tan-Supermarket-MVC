<%- include('partials/head', { pageTitle: 'Notifications', bodyClass: 'page-orders' }) %>

<section class="glass-panel">
  <div class="d-flex justify-content-between flex-wrap align-items-center mb-3">
    <div>
      <h2 class="section-title mb-1">Notifications</h2>
      <p class="subtle-text mb-0">All your recent activity updates.</p>
    </div>
    <form action="/notifications/read-all" method="POST" class="m-0">
      <button type="submit" class="btn btn-secondary">Mark all as read</button>
    </form>
  </div>

  <% if (errors && errors.length) { %>
    <div class="toast error mb-3">
      <% errors.forEach(msg => { %><div><%= msg %></div><% }) %>
    </div>
  <% } %>
  <% if (success && success.length) { %>
    <div class="toast success mb-3">
      <% success.forEach(msg => { %><div><%= msg %></div><% }) %>
    </div>
  <% } %>

  <% if (!notifications || !notifications.length) { %>
    <div class="empty-state">
      <p>No notifications yet.</p>
    </div>
  <% } else { %>
    <ul class="notif-list notifications-page">
      <% notifications.forEach(n => { %>
        <li class="notif-item <%= (n.status || '').toLowerCase() === 'unread' ? 'unread' : '' %>">
          <strong><%= n.title %></strong>
          <div class="subtle-text"><%= n.message %></div>
          <div class="subtle-text"><%= new Date(n.created_at).toLocaleString() %></div>
        </li>
      <% }) %>
    </ul>
  <% } %>
</section>

<%- include('partials/footer') %>
