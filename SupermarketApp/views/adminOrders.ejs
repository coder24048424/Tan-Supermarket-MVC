<%- include('partials/head', { pageTitle: 'All orders', bodyClass: 'page-orders' }) %>

<section class="glass-panel">
  <div class="d-flex justify-content-between flex-wrap align-items-center mb-3">
    <div>
      <h2 class="section-title mb-1">All orders</h2>
      <p class="subtle-text mb-0">Review and manage every order across the store.</p>
    </div>
    <a class="btn btn-secondary" href="/inventory">Back to inventory</a>
  </div>

  <% if (errors && errors.length) { %>
    <div class="toast error mb-3">
      <% errors.forEach(msg => { %><div><%= msg %></div><% }) %>
    </div>
  <% } %>
  <% if (success && success.length) { %>
    <div class="toast success mb-3">
      <% success.forEach(msg => { %><div><%= msg %></div><% }) %>
    </div>
  <% } %>

  <% if (!orders || !orders.length) { %>
    <div class="empty-state">
      <p>No orders found.</p>
    </div>
  <% } else { %>
    <div class="table-responsive">
      <table class="table-modern w-100">
        <thead>
          <tr>
            <th>ID</th>
            <th>Customer</th>
            <th>Email</th>
            <th>Total</th>
            <th>Status</th>
            <th>Items</th>
            <th>Date</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% orders.forEach(order => { %>
            <tr>
              <td>#<%= order.id %></td>
              <td><%= order.username %></td>
              <td><%= order.email %></td>
              <td>$<%= Number(order.total || 0).toFixed(2) %></td>
              <td><span class="chip"><%= (order.status || 'pending').toUpperCase() %></span></td>
              <td><%= order.itemCount %></td>
              <td><%= order.created_at ? new Date(order.created_at).toLocaleString() : '' %></td>
              <td><a class="btn btn-link" href="/orders/<%= order.id %>">View</a></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</section>

<%- include('partials/footer') %>
